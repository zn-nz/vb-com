(function(r,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r["ve-com"]={},r.vue,r.elementPlus))})(this,function(r,t,p){"use strict";const Et="",Ct="",St="",kt="",wt="",Bt="",Nt="",Dt="",Vt="",It="",Rt="",Tt="",Lt="",$t="",_t="",At="",De=t.createElementVNode("i",null,null,-1),Ve={key:0,class:"flex al-center p-y-8 m-b-8"},Ie={key:0,style:{width:"55px"},class:"flex ju-center m-r-28"},Re=t.createElementVNode("i",null,null,-1),Te={class:"flex al-center"},Le={key:0,style:{width:"55px"},class:"flex ju-center m-r-28 m-t-24"},$e={class:"m-t-24"},Q={__name:"index",props:{tableQuery:{type:Object,default:()=>({pageIndex:1,pageSize:20})},data:Array,summaryData:Array,total:Number,prop:{type:Object,default:()=>{}},height:{type:String||Number,default:"calc(100% - 500px)"},showIndex:{type:Boolean,default:!1},showSelect:{type:Boolean,default:!1},selectDisabled:Function,headSelect:{type:Boolean,default:!1},hideDftCheckAll:{type:Boolean,default:!0},showP:{type:Boolean,default:!0},showBatchDel:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},customEmpty:{type:Boolean,default:!0}},emits:["handleSizeChange","handleCurrentChange","handleBatchDel","handleSeleted"],setup(e,{expose:l,emit:n}){const a=e,i=t.ref();t.watch(()=>[a.tableQuery],()=>{var d;(d=i.value)==null||d.setScrollTop(0)});const o=t.ref([]);function s(d){var y,E,C;o.value=d,m.value=d.length>0&&d.length<((y=a.data)==null?void 0:y.length),S.value=((E=a.data)==null?void 0:E.length)>0&&d.length===((C=a.data)==null?void 0:C.length),n("handleSeleted",o.value)}function c(){n("handleBatchDel",o.value)}function h(d,y){if(y.rowIndex)d=y.rowIndex;else if(y.rowIndex===!1)return"";const{pageIndex:E=1,pageSize:C=20}=a.tableQuery;return d+1+(E-1)*C}const m=t.ref(!1),S=t.ref(!1);function u(){i.value.toggleAllSelection()}function b(d,y){return a.selectDisabled&&a.selectDisabled(y)&&(d!=null&&d.isSelected(y))&&d.toggleRowSelection(y),d==null?void 0:d.isSelected(y)}return l({handleCheckAll:u}),(d,y)=>{var C,V,B,R;const E=t.resolveDirective("loading");return t.withDirectives((t.openBlock(),t.createElementBlock("div",{class:"zn-table-content",style:t.normalizeStyle({height:e.height})},[t.createVNode(t.unref(p.ElTable),t.mergeProps({ref_key:"tableRef",ref:i,class:["flex-1",{"hide-checkAll":e.hideDftCheckAll&&!e.headSelect}],data:e.data,onSelectionChange:s},{...d.$attrs,...e.prop}),t.createSlots({append:t.withCtx(()=>{var g;return[t.renderSlot(d.$slots,"append"),(g=e.data)!=null&&g.length&&e.showBatchDel?(t.openBlock(),t.createElementBlock("div",Ve,[e.showSelect?(t.openBlock(),t.createElementBlock("div",Ie,[t.createVNode(t.unref(p.ElCheckbox),{"model-value":S.value,indeterminate:m.value,class:"table-check-all",onChange:u},null,8,["model-value","indeterminate"])])):t.createCommentVNode("",!0),t.renderSlot(d.$slots,"batch-action",{selection:o.value},()=>{var N;return[t.createVNode(t.unref(p.ElButton),{disabled:!((N=o.value)!=null&&N.length),plain:"",type:"danger",onClick:c},{default:t.withCtx(()=>[t.createTextVNode("批量删除")]),_:1},8,["disabled"])]})])):t.createCommentVNode("",!0)]}),default:t.withCtx(()=>[e.showSelect?(t.openBlock(),t.createBlock(t.unref(p.ElTableColumn),{key:0,type:"selection",width:"55",align:"center"},{header:t.withCtx(()=>[De]),default:t.withCtx(g=>[t.renderSlot(d.$slots,"select",t.normalizeProps(t.guardReactiveProps(g)),()=>[t.createVNode(t.unref(p.ElCheckbox),{disabled:e.selectDisabled&&e.selectDisabled(g.row),"model-value":b(g.store,g.row),onChange:N=>g.store.toggleRowSelection(g.row)},null,8,["disabled","model-value","onChange"])])]),_:3})):t.createCommentVNode("",!0),e.showIndex?(t.openBlock(),t.createBlock(t.unref(p.ElTableColumn),{key:1,label:"序号",type:"index",align:"center",width:"70"},{default:t.withCtx(({$index:g,row:N})=>[t.createTextVNode(t.toDisplayString(h(g,N)),1)]),_:1})):t.createCommentVNode("",!0),t.renderSlot(d.$slots,"default")]),_:2},[e.customEmpty?{name:"empty",fn:t.withCtx(()=>[t.createElementVNode("div",null,[e.loading?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock(t.unref(p.ElEmpty),{key:0,style:{width:"100%",height:"100%"}}))])]),key:"0"}:void 0]),1040,["class","data"]),(C=e.summaryData)!=null&&C.length?(t.openBlock(),t.createBlock(t.unref(p.ElTable),{key:0,data:e.summaryData,"show-header":!1},{empty:t.withCtx(()=>[Re]),default:t.withCtx(()=>[e.showSelect?(t.openBlock(),t.createBlock(t.unref(p.ElTableColumn),{key:0,width:"55"})):t.createCommentVNode("",!0),e.showIndex?(t.openBlock(),t.createBlock(t.unref(p.ElTableColumn),{key:1,width:"60"})):t.createCommentVNode("",!0),t.renderSlot(d.$slots,"summary-columns",{},()=>[t.renderSlot(d.$slots,"default")])]),_:3},8,["data"])):t.createCommentVNode("",!0),t.withDirectives(t.createElementVNode("div",Te,[e.showSelect&&!e.headSelect&&(e.hideDftCheckAll&&!e.showBatchDel||d.$slots.footer)?(t.openBlock(),t.createElementBlock("div",Le,[t.createVNode(t.unref(p.ElCheckbox),{"model-value":S.value,indeterminate:m.value,class:"table-check-all",onChange:u},null,8,["model-value","indeterminate"])])):t.createCommentVNode("",!0),t.createElementVNode("div",$e,[t.renderSlot(d.$slots,"footer",{selection:o.value})]),e.showP?(t.openBlock(),t.createBlock(t.unref(p.ElPagination),{key:1,class:"table-pagination m-t-24",currentPage:(V=e.tableQuery)==null?void 0:V.pageIndex,"page-size":(B=e.tableQuery)==null?void 0:B.pageSize,"page-sizes":[20,30,50,100,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total??0,onSizeChange:y[0]||(y[0]=g=>n("handleSizeChange",g)),onCurrentChange:y[1]||(y[1]=g=>n("handleCurrentChange",g))},null,8,["currentPage","page-size","total"])):t.createCommentVNode("",!0)],512),[[t.vShow,(R=e.data)==null?void 0:R.length]])],4)),[[E,e.loading]])}}},Ot="",zt="",_e={__name:"index",props:["modelValue"],emits:["update:modelValue","change","blur"],setup(e,{emit:l}){const n=e,a=t.computed({get(){return n.modelValue},set(o){n.modelValue!==o&&(l("update:modelValue",o),l("change",o))}});function i({target:{value:o}}){const s=Number(o);a.value=s,l("blur",s)}return(o,s)=>(t.openBlock(),t.createBlock(t.unref(p.ElInputNumber),{modelValue:t.unref(a),"onUpdate:modelValue":s[0]||(s[0]=c=>t.isRef(a)?a.value=c:null),class:"el-input-number",controls:!1,onBlur:i},null,8,["modelValue"]))}},Mt="";/*! Element Plus Icons Vue v2.0.10 */var Z=(e,l)=>{let n=e.__vccOpts||e;for(let[a,i]of l)n[a]=i;return n},Ae={name:"Loading"},Oe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},ze=t.createElementVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),Me=[ze];function Fe(e,l,n,a,i,o){return t.openBlock(),t.createElementBlock("svg",Oe,Me)}var xe=Z(Ae,[["render",Fe],["__file","loading.vue"]]),je={name:"Search"},Ge={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},Ue=t.createElementVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1),Qe=[Ue];function Ze(e,l,n,a,i,o){return t.openBlock(),t.createElementBlock("svg",Ge,Qe)}var qe=Z(je,[["render",Ze],["__file","search.vue"]]);const Ft="",He=(e,l)=>{const n=e.__vccOpts||e;for(const[a,i]of l)n[a]=i;return n},Ke={class:"list-scroll-search"},We={key:0,class:"list"},Pe=["onClick"],q=He({__name:"index",props:{api:Promise,searchKey:String,placeholder:String,formatDataFc:Function,defaultParams:Object,modelValue:String,label:String,defaultFirst:{type:Boolean,default:!1},option:{type:Object,default:()=>({key:"id",label:"label"})}},emits:["update:modelValue","change","update:label"],setup(e,{expose:l,emit:n}){const a=e,i=t.ref([]),o=t.ref({pageIndex:1,pageSize:20}),s=t.ref();let c=!1;const h=t.ref(!1),m=t.ref(!1);t.onMounted(()=>{m.value=!0,u()}),t.watch(()=>JSON.stringify(a.defaultParams),()=>{S()});function S(){i.value=[],s.value=void 0,o.value.pageIndex=1,u()}async function u(){const{option:E,api:C,searchKey:V,formatDataFc:B}=a;h.value=!0;const R={...a.defaultParams,...o.value,[V]:s.value},{data:g}=await C(R);h.value=!1;const{ok:N,data:I}=g??{};if(N&&(I!=null&&I.length)){let f=I.filter(k=>i.value.every(w=>w[E.key]!==k[E.key]));B&&(f=B(f)),i.value.push(...f),a.modelValue?i.value.find(w=>w[a.option.key]===a.modelValue)||b():!a.modelValue&&a.defaultFirst&&y(0),(I==null?void 0:I.length)<o.value.pageSize&&(c=!0)}else c=!0;i.value.length||y(-1)}function b(){!c&&!h.value&&(o.value.pageIndex++,u())}function d(){o.value.pageIndex=1,i.value=[],u()}function y(E){let C,V;E!==-1&&(C=i.value[E][option.key],V=i.value[E][option.label]),n("update:modelValue",C),n("update:label",V),n("change",C)}return l({handleSearch:d}),(E,C)=>{const V=t.resolveDirective("infinite-scroll");return t.openBlock(),t.createElementBlock("div",Ke,[t.createVNode(t.unref(p.ElInput),{placeholder:e.placeholder,modelValue:s.value,"onUpdate:modelValue":C[0]||(C[0]=B=>s.value=B),clearable:"",onClear:d,onKeyup:t.withKeys(d,["enter"])},{suffix:t.withCtx(()=>[t.createVNode(t.unref(p.ElIcon),{class:"pointer",onClick:d},{default:t.withCtx(()=>[t.createVNode(t.unref(qe))]),_:1})]),_:1},8,["placeholder","modelValue","onKeyup"]),m.value?t.withDirectives((t.openBlock(),t.createElementBlock("ul",We,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(i.value,(B,R)=>(t.openBlock(),t.createElementBlock("li",{key:R,class:t.normalizeClass({active:e.modelValue===B[e.option.key]}),onClick:g=>y(R)},t.toDisplayString(B[e.option.label]),11,Pe))),128))])),[[V,b]]):t.createCommentVNode("",!0),h.value?(t.openBlock(),t.createBlock(t.unref(p.ElIcon),{key:1,class:t.normalizeClass({"is-loading":h.value&&!t.unref(c)})},{default:t.withCtx(()=>[t.createVNode(t.unref(xe))]),_:1},8,["class"])):t.createCommentVNode("",!0),t.withDirectives(t.createVNode(t.unref(p.ElEmpty),{style:{width:"100%"}},null,512),[[t.vShow,!h.value&&!i.value.length]])])}}},[["__scopeId","data-v-078657fe"]]),Je={__name:"index",props:{loading:Boolean,diffBottom:{type:Number,default:20}},emits:["loadMore","visible-change","remote-method"],setup(e,{emit:l}){const n=e,a=t.ref();let i,o,s;function c(u){(!u||s!==u)&&(o=void 0,i==null||i.scrollTo({top:0})),s=u,l("remote-method",u)}function h(u){l("visible-change",u),u?m():i==null||i.removeEventListener("scroll",S)}function m(){setTimeout(()=>{i=a.value.scrollbar.wrapRef;const u=i.querySelector(".selected");let b=0;u&&(b=u.offsetTop-(i.offsetHeight-34)),i==null||i.scrollTo({top:b}),o=void 0,i==null||i.addEventListener("scroll",S)},0)}function S({target:{offsetHeight:u,scrollHeight:b,scrollTop:d}}){u+d>b-n.diffBottom&&!n.loading&&(o===void 0||o&&o<d)&&(o=d,l("loadMore"))}return(u,b)=>(t.openBlock(),t.createBlock(t.unref(p.ElSelect),{ref_key:"selectRef",ref:a,"remote-method":c,onVisibleChange:h},{default:t.withCtx(()=>[t.renderSlot(u.$slots,"default")]),_:3},512))}},H={__name:"index.v2",props:{api:Promise,searchKey:{type:String,default:"name"},formatSearchKey:Function,formatDataFc:Function,defaultParams:Object,modelValue:[String,Array],allowCreate:Boolean,init:{type:Boolean,default:!0},defaultFirst:{type:Boolean,default:!1},option:{type:Object,default:()=>({key:"id",label:"name"})},insertList:{type:Array,default:()=>[]}},emits:["update:modelValue","change","update:data","visibleChange","clear"],setup(e,{expose:l,emit:n}){const a=e,i=t.ref(null);function o(f){if(I(a.modelValue))i.value=s.value.filter(k=>a.modelValue.includes(k[a.option.key]));else if(a.modelValue){const k=s.value.find(w=>w[a.option.key]===f);!k&&a.allowCreate?i.value=a.modelValue:i.value=k}else i.value=null;f!==a.modelValue&&n("change",i.value)}const s=t.ref([]);let c=[],h=[],m=!1;const S=t.ref({pageIndex:1,pageSize:20}),u=t.ref();let b=!1;const d=t.ref(!1);t.onMounted(()=>{a.init&&E()}),t.watch(()=>JSON.stringify(a.defaultParams),()=>{y()}),t.watch(()=>a.insertList,()=>{g()}),t.watch(()=>a.modelValue,o);function y(){s.value=[],c=[],u.value=void 0,S.value.pageIndex=1,E()}async function E(){const{option:f,api:k,searchKey:w,formatSearchKey:x,formatDataFc:Ne,allowCreate:qt}=a;if(!a.api)throw"scroll-select-v2 组件 未定义api";d.value=!0;let U={...a.defaultParams,...S.value,[w]:u.value};x&&(U={...U,...x(u.value)});const{data:yt}=await k(U);d.value=!1;const{ok:bt,data:T}=yt??{};if(bt){let $=(T==null?void 0:T.filter(_=>!s.value.find(M=>M[f.key]===_[f.key])))||[];if(Ne&&($=Ne($)),u.value)b=~~(T==null?void 0:T.length)<S.value.pageSize,h.push(...$),s.value=[...h];else{if($!=null&&$.length&&c.push(...$),g(),m=b=~~(T==null?void 0:T.length)<S.value.pageSize,a.modelValue)if(I(a.modelValue)){const _=s.value.filter(M=>a.modelValue.includes(M[a.option.key]));_.length<a.modelValue.length&&C(),N(_)}else{const _=s.value.find(M=>M[f.key]===a.modelValue);_?N(_):C()}!a.modelValue&&a.defaultFirst&&N(s.value[0])}}else b=!0}function C(){!b&&!d.value&&(S.value.pageIndex++,E())}function V(f){f?(h=[],u.value=f,S.value.pageIndex=1,s.value=[],E()):B(!1)}function B(f){a.modelValue||(f?(g(),b=m):u.value=void 0),f||(u.value=void 0,c.push(...(h==null?void 0:h.filter(k=>!c.find(w=>w[option.key]===k[option.key])))||[]),g(),b=m),n("visibleChange",f)}function R(){n("clear"),u.value=void 0,S.value.pageIndex=1,g(),b=m}function g(){const f=(c==null?void 0:c.filter(k=>!a.insertList.find(w=>w[option.key]===k[option.key])))||[];s.value=[...a.insertList,...f]}function N(f){let k=f==null?void 0:f[a.option.key];I(f)&&(k=f.map(w=>w[a.option.key])),i.value=f,n("update:modelValue",k),n("update:data",f),k!==a.modelValue&&n("change",f)}function I(f){return Object.prototype.toString.call(f)==="[object Array]"}return l({reset:y,initData:g}),(f,k)=>(t.openBlock(),t.createBlock(Je,{loading:d.value,"model-value":i.value,"loading-text":"加载中...","no-match-text":"未查询到数据","no-data-text":"未查询到数据",clearable:"",filterable:"","fit-input-width":"",remote:"","reserve-keyword":"","remote-show-suffix":"",allowCreate:e.allowCreate,onRemoteMethod:V,onLoadMore:C,onClear:R,onVisibleChange:B,onChange:N,"value-key":e.option.key},{default:t.withCtx(()=>[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(s.value,w=>(t.openBlock(),t.createBlock(t.unref(p.ElOption),{key:w[e.option.key],label:e.option.label.split(",").map(x=>w[x]).join("-"),value:w},null,8,["label","value"]))),128))]),_:1},8,["loading","model-value","allowCreate","value-key"]))}},jt="",Ye={零:0,一:1,二:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9},K={十:{value:10,secUnit:!1},百:{value:100,secUnit:!1},千:{value:1e3,secUnit:!1},万:{value:1e4,secUnit:!0},亿:{value:1e8,secUnit:!0}};function W(e){for(var l=0,n=0,a=0,i=!1,o=e.split(""),s=0;s<o.length;s++){var c=Ye[o[s]];if(typeof c<"u")a=c,s===o.length-1&&(n+=a);else{var h=K[o[s]].value;i=K[o[s]].secUnit,i?(n=(n+a)*h,l+=n,n=0):n+=a*h,a=0}}return l+n}const Xe=e=>new RegExp(`<${e}[^>]*>[\\s\\S]*?</[^>]*${e}>`,"i"),P=/^[\u4e00-\u9fa5]+$/,J=/^1[3-9]\d{9}$/,Y=/^[0-9]{4}-\d{7}$/,X=/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,v=/^https?:\/\/.{1,}\..{1,}$/i,ee=/^[0-9]+$/,te=/^\d+\.*[\d+]{0,}$/,ae=/[\u4E00-\u9FFF]+/g,le=/^[a-z0-9]+$/i,ve=/^-[0-9]+$/i,ne=/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/,oe=/^[a-zA-Z0-9]{10,20}$/,ie=/^(?![A-Za-z0-9]+$)(?![a-z0-9\W]+$)(?![A-Za-z\W]+$)(?![A-Z0-9\W]+$)[a-zA-Z0-9\W]{6,20}$/,se=/^[0-9a-zA-Z]{4}$/,re=/[^_IOZSVa-z\W]{2}\d{6}[^_IOZSVa-z\W]{10}$/g,ce=/^([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[a-zA-Z](([DF]((?![IO])[a-zA-Z0-9](?![IO]))[0-9]{4})|([0-9]{5}[DF]))|[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1})$/,A=/[一二三四五六七八九十]{1,}/,et=/<tr[^>]*>[^\{^\}]*?\[{1}[\s\S^\{^\}]*?\]{1}[^\{^\}]*?<\/[^>]*tr>/gi,tt=/<td[^>]*>[\s\S]*?<\/[^>]*td>/gi,at=e=>typeof e=="string",de=e=>J.test(e),ue=e=>Y.test(e),he=e=>X.test(e),fe=e=>v.test(e),me=e=>te.test(e),ge=e=>ee.test(e),pe=e=>le.test(e),lt=e=>ae.test(e),ye=e=>ne.test(e),nt=e=>oe.test(e),be=e=>ie.test(e),Ee=e=>se.test(e),Ce=e=>re.test(e),Se=e=>ce.test(e),L=e=>P.test(e),ke=e=>{const l=new FormData;return Object.keys(e).forEach(n=>{e[n]!==null&&l.append(n,e[n])}),l},ot=(e,l=!0)=>{const n=document.createElement("a");n.href=e,l&&(n.target="_blank"),n.click()},it=e=>{const[l,...n]=e.split(".").reverse();return[n.reverse().reduce((a,i)=>a+i,""),l]},st=e=>{switch(!0){case e/1024<1024:return`${(e/1024).toFixed(2)}kb`;default:return`${(e/1024/1024).toFixed(2)}Mb`}},O=e=>Object.prototype.toString.call(e),j=(e,l,n=!1)=>{if(Object.prototype.toString.call(e)!=="[object Array]")return[];const a=l==null?void 0:l.split(",");function i(o,s){var h,m;switch(!0){case(!!((h=o==null?void 0:o.match(A))!=null&&h.length)&&!!((m=s==null?void 0:s.match(A))!=null&&m.length)):return W(o.match(A)[0])-W(s==null?void 0:s.match(A)[0]);case(L(o)&&L(s)):case(L(o)&&!L(s)):return-1;case(!L(o)&&L(s)):return 1}let c=0;return(o==null?void 0:o.length)!==(s==null?void 0:s.length)?c+=(o==null?void 0:o.length)-(s==null?void 0:s.length):c+=(o==null?void 0:o.localeCompare(s))+((o-s)*2||0),c}return e.sort((o,s)=>{let c=0;if(a)a==null||a.forEach(h=>{var m,S;try{const u=(m=o==null?void 0:o[h])==null?void 0:m.toString().trim(),b=(S=s==null?void 0:s[h])==null?void 0:S.toString().trim();c+=i(u,b)}catch(u){console.log(u)}});else{const h=o==null?void 0:o.toString().trim(),m=s==null?void 0:s.toString().trim();c+=i(h,m)}return c*(n?-1:1)})},rt=(e,l,n="children")=>j(e,l).map(({[n]:a,...i})=>({...i,children:j(a,l)})),we=e=>new Promise(l=>{const n=document.createElement("input");e&&(n.accept=e),n.type="file",n.onchange=a=>{const i=a.target.files[0];a.target.value=null,l(i)},n.click()}),G=(e,l,n="application/vnd.ms-excel;charset=utf-8")=>{let a;e instanceof Blob?a=e:a=new Blob([e],{type:n});const i=window.URL.createObjectURL(a),o=document.createElement("a");o.download=l,o.href=i,o.click(),o.remove(),window.URL.revokeObjectURL(i)},F=(e,l=2)=>{switch(O(e)){case"[object Number]":return Math.round(e*Math.pow(10,l))/Math.pow(10,l);default:return e??0}},ct=e=>{const{columns:l,data:n}=e,a=[];return l.forEach((i,o)=>{if(o===0){a[o]="合计";return}const s=n==null?void 0:n.map(c=>Number(c[i.property]||c[i]||0));s.every(c=>Number.isNaN(c))?a[o]="":a[o]=`${s.reduce((c,h)=>{const m=Number(h);return Number.isNaN(m)?c:F(c+h)},0)}`}),a},dt=e=>{const{columns:l,data:n}=e,a=[];return l.forEach((i,o)=>{if(o===0){a[o]="";return}if(o===1){a[o]="合计";return}const s=n.map(c=>Number(c[i.property]||0));s.every(c=>Number.isNaN(c))?a[o]="":a[o]=`${s.reduce((c,h)=>{const m=Number(h);return Number.isNaN(m)?c:F(c+h)},0)}`}),a},ut=(e,l,n)=>{const a={[n]:"合计"};return e.forEach(i=>{l.forEach(o=>{a[o]=F((a[o]||0)+Number(i[o]||0))})}),a},D=(e,l="请正确填写")=>({validator:(n,a,i)=>{let o=!0;switch(O(e)){case"[object Function]":o=e(a);break;case"[object Array]":o=e.some(c=>c(a));break;case"[object Object]":o=Object.values(e).every(c=>c(a));break}return!a||a===0||o?i():i(l)},trigger:"blur"}),ht={url:D(fe),phone:D([de,ue]),email:D(he),double:D(me),int:D(ge),intAndLetter:D(pe),idCard:D(ye),psw:D(be,"密码必须包含大小写字母、数字和特殊字符，长度为6-20位"),captcha:D(Ee),socialCreditCode:D(Ce),carNumber:D(Se)},ft={required:!0,message:"必填项",validator:function(e,l,n){const a=O(l);let i=!0;switch(a){case"[object String]":l!=null&&l.trim()||(i=!1);break;case"[object Number]":break;case"[object Array]":i=!!(l!=null&&l.length);break;default:i=!!l;break}return i?n():n(this.message)},trigger:"blur"},Gt="",Ut="",Qt="",Zt="",mt={image:"image/*",xlsx:".csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",video:"video/*",all:"*"},z={create:"create",update:"update"},gt={data(){return{tableData:[],tableQuery:{pageIndex:1,pageSize:20},temp:{},dialogVisible:!1,total:0,tableLoading:!1,handleLoading:!1,dialogTypeOpt:z,dialogType:"",dialogTitleMap:{[z.create]:"新增",[z.update]:"修改"}}},created(){this.fetchData(),this.getTableData()},methods:{handleSearch(){this.tableQuery.pageIndex=1,this.total=0,this.getTableData()},handleCreate(){this.resetTemp(),this.dialogType=z.create,this.dialogVisible=!0},handleDelete(e,l){this.temp=e,this.showConfirm(l||this.confirmDelete)},handleBatchDel(e){this.showConfirm(e||this.confirmBatchDelete)},confirmBatchDelete(){console.log("未定义confirmBatchDelete方法")},showConfirm(e){p.ElMessageBox.confirm("是否确定此操作？","系统提示",{type:"warning",autofocus:!1}).then(e).catch()},async handleUpdateBefore({id:e}){var l;if((l=this.apiOpt)!=null&&l.detail){const n=this.getDetailQuery(e),{data:{ok:a,data:i}}=await this.apiOpt.detail(n);a&&this.handleUpdate(i,this.next)}else console.log("未定义handleUpdateBefore方法")},getDetailQuery(e){return{id:e}},handleUpdate(e,l){this.resetTemp(),this.temp={...e},l&&l(e),this.dialogType=z.update,this.dialogVisible=!0},async getTableData(){var e;if((e=this.apiOpt)!=null&&e.list){const l=this.getTableQuery();if(!l){this.total=0,this.tableData=[];return}this.tableLoading=!0;const{data:n}=await this.apiOpt.list(l);this.tableLoading=!1,this.getTableDataNormalSuccess(n)}else console.log("未定义getTableData方法")},getTableQuery(){return this.tableQuery},handleConfirm(){var e;(e=this.$refs.formRef)==null||e.validate(l=>{if(l)switch(this.dialogType){case"create":this.confirmCreate();break;case"update":this.confirmUpdate();break}else console.warn(this.temp)})},async confirmCreate(){var e;if((e=this.apiOpt)!=null&&e.create){const l=this.getCreateQuery();this.handleLoading=!0;const{data:n}=await this.apiOpt.create(l);this.handleSuccess(n)}else console.log("未定义confirmCreate方法")},getCreateQuery(){return this.temp},async confirmDelete(){var e;if((e=this.apiOpt)!=null&&e.del){const l=this.getDelQuery(),{data:n}=await this.apiOpt.del(l);this.handleSuccess(n)}else console.log("未定义confirmDelete方法")},getDelQuery(){return{idList:this.temp.id}},async confirmUpdate(){var e;if((e=this.apiOpt)!=null&&e.update){const l=this.getUpdateQuery();this.handleLoading=!0;const{data:n}=await this.apiOpt.update(l);this.handleSuccess(n)}else console.log("未定义confirmUpdate方法")},getUpdateQuery(){return this.temp},handleSuccess({ok:e}){this.handleLoading=!1,e?(p.ElMessage.success("操作成功"),this.dialogVisible=!1,this.getTableData()):p.ElMessage.warning("操作失败")},getTableDataNormalSuccess({ok:e,data:l,count:n}){this.tableLoading=!1,e?(this.tableData=l,this.total=n):(this.tableData=[],this.total=0)},handleCurrentChange(e){this.tableQuery.pageIndex=e,this.getTableData()},handleSizeChange(e){this.tableQuery.pageSize=e,this.getTableData()},resetTemp(){var e;(e=this.$refs.formRef)==null||e.resetFields(),this.temp={}},reset(){this.tableQuery={pageIndex:1,pageSize:20},this.getTableData()},async handleImport(){var e;if((e=this.apiOpt)!=null&&e.import){const l=await we(mt.xlsx),n=this.getImportQuery(l);this.handleLoading=!0;const{data:a}=await this.apiOpt.import(ke(n),{responseType:"blob"});this.handleImportSuccess(a)}else console.log("未定义handleImport方法")},handleImportSuccess(e){this.handleLoading=!1;const l=O(e);switch(!0){case l==="[object Object]":this.handleImportSomeSuccess(e);break;case(l==="[object Blob]"&&e.type.includes("json")):{const n=new FileReader;n.readAsText(e,"utf-8"),n.onload=()=>{this.handleImportSomeSuccess(JSON.parse(n.result))}}break;case l==="[object Blob]":p.ElMessageBox.alert("部分上传成功，请修改失败的部分重新上传","系统提示",{autofocus:!1,type:"warning"}),G(e,"导入失败部分.xlsx");break}},handleImportSomeSuccess(e){const{ok:l,data:n}=e;if(l){const{errorCount:a}=n||{};a?(p.ElMessageBox.alert("部分上传成功，请修改失败的部分重新上传","系统提示",{autofocus:!1,type:"warning"}),this.handleImportError(e)):this.handleSuccess(e)}},handleImportError(){console.log("未定义handleImportError方法")},getImportQuery(e){return{file:e}},async handleDownload(){var e;if((e=this.apiOpt)!=null&&e.download){this.handleLoading=!0;const l=this.getDownloadQuery(),{data:n}=await this.apiOpt.download(l,{responseType:"blob"});this.handleLoading=!1,G(n,`${this.fileName||Date.now()}.xlsx`)}else console.log("未定义handleDownload方法")},getDownloadQuery(){return null},async handleTemplate(){},fetchData(){}}},Be={VeTable:Q,VeInputNumber:_e,VeListScrollSearch:q,VeScrollSelect:H},pt={VeTable:Q,VeListScrollSearch:q,VeScrollSelect:H,install(e){for(const l in Be)e.component(l,Be[l])}};r.REGBUSINESSLICENSE=oe,r.REGCAPTCHA=se,r.REGCARNUMBER=ce,r.REGCH=P,r.REGCHINESENUM=A,r.REGDOUBLE=te,r.REGEMAIL=X,r.REGIDCARD=ne,r.REGINT=ee,r.REGINTANDLETTER=le,r.REGLANDLINE=Y,r.REGMOBILE=J,r.REGPSW=ie,r.REGRECHINESE=ae,r.REGRENEGATIVE=ve,r.REGTABLECYCLETR=et,r.REGURL=v,r.SOCIALCREDITCODE=re,r.default=pt,r.downloadFile=G,r.formatFileNameSuffix=it,r.formatFileSize=st,r.formatNumber=F,r.getMoreSummaries=dt,r.getSummaries=ct,r.getSummaryDatas=ut,r.isBusinessLicense=nt,r.isCH=L,r.isCarNumber=Se,r.isChinese=lt,r.isCpatcha=Ee,r.isDouble=me,r.isEmail=he,r.isIdCard=ye,r.isInt=ge,r.isIntAndLetter=pe,r.isLandLine=ue,r.isMobile=de,r.isPsw=be,r.isSocialCreditCode=Ce,r.isStr=at,r.isUrl=fe,r.jumpExternalChain=ot,r.obj2Formdata=ke,r.recursionSort=rt,r.regTag=Xe,r.regTd=tt,r.required=ft,r.selectLocalFile=we,r.sortFuc=j,r.tableMixin=gt,r.typeCheck=O,r.validatorFun=ht,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
